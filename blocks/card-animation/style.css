
/* Section shell */
.guides {
  background:
    radial-gradient(1200px 600px at 20% 15%, var(--bg-left, #cee6f2) 0%, rgba(238,247,252,0) 60%),
    linear-gradient(90deg, #f1f7fb 0%, var(--bg-right, #e3867d) 100%);
  padding: 0px 10px 50px;
}

.g-wrap {
  max-width: 1160px;
  margin: 0 auto;
}

.g-head {
  text-align: center;
  margin-bottom: 18px;
}

.g-head h2 {
  margin: 0 0 6px;
  color: var(--brand);
}

.g-head p {
  margin: 0;
  color: var(--muted); /* was var(--shadow) which isn't a color */
}

/* Card rail as interactive accordion */
.g-rail {
  list-style: none;
  margin: 16px 0 0;
  padding: 0;
  display: flex;
  gap: var(--rail-gap);
  align-items: stretch;
  min-height: var(--height-desktop);
}

.g-item {
  position: relative;
  flex: 1 1 var(--collapsed);
  border: 1px solid var(--line);
  border-radius: 22px;
  overflow: hidden;
  box-shadow: var(--shadow) !important;
  cursor: pointer;
  transition: flex-basis .28s ease, flex-grow .28s ease, transform .2s ease;
  min-width: 80px;
  height: 500px;
}

.g-item.active {
  flex: 0 1 var(--expanded);
}

.g-item:not(.active) {
  opacity: .95;
}

.g-link {
  display: block;
  height: 100%;
  position: relative;
  text-decoration: none;
  color: inherit;
}

.g-media {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  filter: saturate(.98) contrast(1) brightness(.98);
}

.g-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 16px;
  color: #fff;
  text-shadow: 0 2px 6px rgba(0,0,0,.25);
  background: linear-gradient(0deg, rgba(0,0,0,.45), rgba(0,0,0,0) 55%);
}

/* Hide text by default; reveal on active (desktop/tablet) */
.g-overlay h3 {
  margin: 0 0 6px;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity .2s ease, transform .2s ease;
}

.g-overlay p {
  margin: 0;
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-height .25s ease, opacity .2s ease, transform .2s ease;
  transform: translateY(6px);
}

.g-item.active .g-overlay h3 {
  opacity: 1;
  transform: none;
}

.g-item.active .g-overlay p {
  max-height: 180px;
  opacity: 1;
  transform: none;
}

.g-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 14px 30px rgba(0,0,0,.1);
}

/* Responsive */
@media (max-width: 1000px) {
  .g-rail {
    min-height: 320px;
  }
}

@media (max-width: 760px) {
  /* Mobile deck: stack cards and rotate on tap via JS */
  .g-rail {
    position: relative;
    display: block;
    /* Size and center the deck like the reference */
    --deck-w: min(84vw, 360px);
    --deck-h: var(--deck-w);
    width: var(--deck-w);
    height: var(--deck-h);
    margin-inline: auto;
    min-height: unset;
    overflow: visible;
    transition: none;
  }

  .g-item {
    position: absolute;
    inset: 0;
    flex: none;
    height: 100%;
    border: 1px solid #e6e2e1;
    border-radius: 16px;
    box-shadow:
      0 10px 18px rgba(0,0,0,.18),
      0 24px 42px rgba(0,0,0,.18);
    transform-origin: center bottom;
    transition: transform .55s cubic-bezier(0.22, 0.61, 0.36, 1), box-shadow .4s ease, opacity .55s ease;
  }

  /* deck layering using nth-child; DOM order updates on tap */
  .g-item:nth-child(1) { z-index: 5; transform: rotate(0deg) translate(0,0) scale(1); opacity:1; pointer-events:auto; }
  .g-item:nth-child(2) { z-index: 4; transform: rotate(8deg) translate(-8px, 10px) scale(.98); }
  .g-item:nth-child(3) { z-index: 3; transform: rotate(-12deg) translate(10px, 20px) scale(.965); }
  .g-item:nth-child(4) { z-index: 2; transform: rotate(15deg) translate(-14px, 30px) scale(.95); }
  .g-item:nth-child(n+5) { opacity: 0; pointer-events: none; }

  /* Previously hid all overlays on mobile; keep rule but override for the top/active card */
  .g-overlay { display: none; }

  /* Show overlay + text for the top card */
  .g-item:nth-child(1) .g-overlay{
    display: flex;
    background: linear-gradient(0deg, rgba(0,0,0,.55), rgba(0,0,0,0) 60%);
    padding: 14px;
  }
  .g-item:nth-child(1) .g-overlay h3{
    opacity: 1;
    transform: none;
    /* optional 2-line clamp on small screens */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .g-item:nth-child(1) .g-overlay p{
    opacity: 1;
    transform: none;
    max-height: 9em;              /* ~6 lines; adjust as needed */
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 4;        /* clamp lines on small screens */
    -webkit-box-orient: vertical;
  }

  /* If you toggle an 'active' card via JS, show its overlay as well */
  .g-item.active .g-overlay{
    display: flex;
    background: linear-gradient(0deg, rgba(0,0,0,.55), rgba(0,0,0,0) 60%);
    padding: 14px;
  }
  .g-item.active .g-overlay h3,
  .g-item.active .g-overlay p{
    opacity: 1;
    transform: none;
  }
  .g-item.active .g-overlay p{
    max-height: 9em;
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* No animation on mobile: static scattered stack */
  .g-item.leaving,
  .g-item.entering { animation: none; }

  /* Card frame and subtle parallax */
  .g-media{
    transition: transform .55s cubic-bezier(0.22, 0.61, 0.36, 1);
    border-radius: 14px;
    overflow: hidden;
  }
  .g-media::after{
    content:"";
    position:absolute; inset:0;
    border-radius:14px;
    box-shadow: inset 0 0 0 8px #fff;
    pointer-events:none;
  }
  .g-item.leaving .g-media,
  .g-item.entering .g-media{ transform: none; }
}
